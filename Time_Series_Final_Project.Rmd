---
title: "Time Series Final Project"
output: html_document
date: "2024-03-20"
---

# Download Gas Data:

```{r}

#install.packages("readxl")
library(readxl)
library(ggplot2)
setwd("~/Desktop")

gas_data <- read_excel("GasData.xlsx")
head(gas_data)

colnames(gas_data) <- c("date", "price")


gas_ts <- ts(gas_data$price, frequency = 52)  

plot(gas_ts, xlab = "Years from 1993", ylab = "Price", main = "Weekly Gas Price Time Series")

```

# Classical Decomposition:

```{r}


ts_data <- ts(gas_data, frequency = 365)  

decomposed_ts <- decompose(ts_data, type = "additive")  



plot(decomposed_ts$trend, main = "Trend Component", xlab = "Date", ylab = "Value")

plot(decomposed_ts$seasonal, main = "Seasonal Component", xlab = "Date", ylab = "Value")

plot(decomposed_ts$random, main = "Random Component", xlab = "Date", ylab = "Value")


```

# Perform Dicky-Fuller Test to check for Unit Root:

```{r}

#install.packages("tseries")
library(tseries)

ts_values <- as.numeric(ts_data)

adf_test_result <- adf.test(ts_values)

print(adf_test_result)

```

Fail to reject null-hypothesis since p-value is larger than .05 --\> non-stationary data

# Box-Cox to Stabilize Variance:

```{r}

lambda <- BoxCox.lambda(ts_data)
ts_boxcox <- BoxCox(ts_data, lambda)
    
plot(ts_data)

plot(ts_boxcox)




```

```{r}

# First-order differencing to remove trend
trend_removed_ts <- diff(ts_data, differences = 1)

# Seasonal differencing of one year (assuming frequency is 365)
seasonal_diff_ts <- diff(trend_removed_ts, lag = 365)

# Plot the time series after removing trend and applying seasonal differencing
plot(seasonal_diff_ts, main = "Time Series after Removing Trend and Applying Seasonal Differencing", xlab = "Date", ylab = "Value")

seasonal_diff_ts_numeric <- as.numeric(seasonal_diff_ts)

```

# Perform ADF test again:

```{r}





```

# ACF and PACF of seasonal_diff_ts_numeric:

```{r}

acf(seasonal_diff_ts_numeric, main="ACF")
pacf(seasonal_diff_ts_numeric, main="PACF")
```

# Model:

```{r}

library(forecast)

model <- auto.arima(seasonal_diff_ts_numeric, seasonal = TRUE)

summary(model)


forecast_result <- forecast(model, h = 12)
print(forecast_result)
plot(forecast_result)
```

# 

# Fit SARIMA Model:

```{r}

library(forecast)

# Assuming seasonal_diff_ts_numeric is your time series data

# Fit a SARIMA model with automatic selection
sarima_model <- auto.arima(gas_ts, seasonal = TRUE)

# Summary of the SARIMA model
summary(sarima_model)

# Forecast for the next 12 periods
sarima_forecast_result <- forecast(sarima_model, h = 12)
print(sarima_forecast_result)

# Plot ACF and PACF
par(mfrow=c(1,2))
acf(gas_ts, main="ACF")
pacf(gas_ts, main="PACF")



plot(forecast_result, main="Forecast with Prediction Intervals", xlim=c(length(seasonal_diff_ts_numeric)-100, length(seasonal_diff_ts_numeric)))


```

# Model Diagnostics: 

the Q-Q plot shows that the data is coming
from a normal population (see Appendix.4), and diagnostic plots indicate that the ACF of the residuals and p-values are
not significant, so the model is adequate

```{r}






```

# Smoothing-based Forecast: Holt-Winters:

```{r}




```

# Evaluation of Forecast Accuracy - (Compare MAE, RMSE, MAPE)

```{r}





```
